<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dark Morse Chat ðŸ’¬</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
/* General styling */
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:"Poppins",sans-serif;
  background:radial-gradient(circle at top left,#00111a,#000);
  color:#e0e0e0;
  height:100vh;display:flex;justify-content:center;align-items:center;
  user-select:none;-webkit-user-select:none;-ms-user-select:none;
}
.container{
  width:95%;max-width:420px;background:rgba(0,10,30,.85);
  border-radius:15px;padding:20px;backdrop-filter:blur(15px);
  box-shadow:0 0 25px rgba(0,150,255,.4);border:1px solid rgba(0,150,255,.2)
}
h2{text-align:center;margin-bottom:15px;color:#00bfff;text-shadow:0 0 8px #007acc}
input,button{width:100%;padding:10px;margin:8px 0;border:none;border-radius:10px;font-size:16px}
input{background:rgba(0,50,80,.3);color:#e0e0e0}
input::placeholder{color:#888}
button{
  background:linear-gradient(90deg,#007acc,#00bfff);color:white;font-weight:600;
  cursor:pointer;transition:.3s;box-shadow:0 0 10px rgba(0,150,255,.4)
}
button:hover{
  background:linear-gradient(90deg,#0097a7,#00e6ff);
  box-shadow:0 0 15px rgba(0,150,255,.7)
}
#chatBox{display:none;flex-direction:column;height:420px}
#messages{flex:1;overflow-y:auto;padding:10px;display:flex;flex-direction:column;gap:8px;position:relative}
.bubble{padding:10px 14px;border-radius:12px;max-width:80%;word-wrap:break-word;font-size:15px;transition:0.5s;}
.me{align-self:flex-end;background:linear-gradient(90deg,#0066cc,#0099ff);color:white;box-shadow:0 0 10px rgba(0,150,255,.4);}
.other{align-self:flex-start;background:rgba(0,80,130,.3);color:#b3e5ff;}
#msgInput{background:rgba(0,40,80,.5);color:#fff;}
#codeDisplay{text-align:center;margin-bottom:8px;color:#00bfff;font-weight:500}
#typingIndicator{font-size:14px;color:#00bfff;margin-bottom:4px;height:18px;}
/* Watermark */
#watermark{
  position: fixed; bottom:5px; right:10px;
  opacity:0.15; font-size:12px;
  pointer-events:none; color:#00bfff;
}
/* Scrollbar */
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-thumb{background:#007acc;border-radius:3px}::-webkit-scrollbar-track{background:rgba(255,255,255,.05);}
</style>
</head>
<body>

<div class="container" id="joinSection">
  <h2>âš¡ # Chat</h2>
  <input type="text" id="chatCode" placeholder="Enter or create chat code">
  <button onclick="generateCode()">ðŸŽ² Generate Code</button>
  <button onclick="joinChat()">ðŸš€ Join Chat</button>
</div>

<div class="container" id="chatBox">
  <p id="codeDisplay"></p>
  <div id="typingIndicator"></div>
  <div id="messages"></div>
  <div>
    <input type="text" id="msgInput" placeholder="Type your message..." oninput="notifyTyping()">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<div id="watermark">Â© # Chat</div>

<script>
/* ---------- Firebase Setup ---------- */
const firebaseConfig = {
  apiKey:"YOUR_API_KEY",
  authDomain:"YOUR_PROJECT.firebaseapp.com",
  databaseURL:"https://YOUR_PROJECT.firebaseio.com",
  projectId:"YOUR_PROJECT_ID",
  storageBucket:"YOUR_PROJECT.appspot.com",
  messagingSenderId:"SENDER_ID",
  appId:"APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

/* ---------- Morse Conversion ---------- */
const morseMap={
  A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",I:"..",
  J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",P:".--.",Q:"--.-",R:".-.",
  S:"...",T:"-",U:"..-",V:"...-",W:".--",X:"-..-",Y:"-.--",Z:"--..",
  1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",
  8:"---..",9:"----.",0:"-----"," ":"/"
};
const revMorse=Object.entries(morseMap).reduce((a,[k,v])=>(a[v]=k,a),{});
function textToMorse(txt){ return txt.toUpperCase().split("").map(ch=>morseMap[ch]||"").join(" "); }
function morseToText(code){ return code.split(" ").map(c=>revMorse[c]||"").join(""); }

/* ---------- Chat Logic ---------- */
let chatRef=null, code="", userTag="user-"+Math.random().toString(36).substring(2,5);
let typingTimeout;

function generateCode(){ document.getElementById('chatCode').value=Math.random().toString(36).substring(2,8); }

function joinChat(){
  code=document.getElementById('chatCode').value.trim();
  if(!code)return alert("Enter a chat code!");
  document.getElementById('joinSection').style.display='none';
  document.getElementById('chatBox').style.display='flex';
  document.getElementById('codeDisplay').innerHTML=`ðŸ”— Chat Code: <b>${code}</b>`;
  chatRef=db.ref('chats/'+code);
  
  chatRef.on('child_added',snap=>{
    const data=snap.val();
    const mine=data.user===userTag;
    displayMessage(data.text,mine);
  });

  db.ref('typing/'+code).on('value',snap=>{
    const val=snap.val();
    const indicator=document.getElementById('typingIndicator');
    indicator.textContent=(val && val!==userTag)?"Typing...":"";
  });

  setTimeout(()=>chatRef.remove(),10*60*1000);
}

function sendMessage(){
  const input=document.getElementById('msgInput');
  const msg=input.value.trim(); if(!msg)return;
  chatRef.push({text:msg,user:userTag});
  input.value="";
  setTyping(false);
}

/* ---------- Typing Indicator ---------- */
function notifyTyping(){
  setTyping(true);
  clearTimeout(typingTimeout);
  typingTimeout=setTimeout(()=>setTyping(false),1500);
}
function setTyping(status){ db.ref('typing/'+code).set(status?userTag:null); }

/* ---------- Display Message with Morse Flip & Ephemeral ---------- */
function displayMessage(msg,mine){
  const div=document.createElement('div');
  div.classList.add('bubble',mine?'me':'other');
  div.textContent=msg; // English initially
  const messages=document.getElementById('messages');
  messages.appendChild(div);
  messages.scrollTop=messages.scrollHeight;

  // Flip to Morse after 2 sec
  setTimeout(()=>{
    div.textContent=textToMorse(msg);
    // Remove message 5 sec after Morse
    setTimeout(()=>{ div.remove(); },5000);
  },2000);
}

// Prevent copy/cut
document.addEventListener('copy',e=>e.preventDefault());
document.addEventListener('cut',e=>e.preventDefault());

// Remove chat if user leaves
window.addEventListener('beforeunload',()=>{ if(chatRef) chatRef.remove(); });
</script>

</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dark Morse Chat ðŸ’¬</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
/* General styling */
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:"Poppins",sans-serif;
  background:radial-gradient(circle at top left,#00111a,#000);
  color:#e0e0e0;
  height:100vh;display:flex;justify-content:center;align-items:center;
  user-select:none;-webkit-user-select:none;-ms-user-select:none;
}
.container{
  width:95%;max-width:420px;background:rgba(0,10,30,.85);
  border-radius:15px;padding:20px;backdrop-filter:blur(15px);
  box-shadow:0 0 25px rgba(0,150,255,.4);border:1px solid rgba(0,150,255,.2)
}
h2{text-align:center;margin-bottom:15px;color:#00bfff;text-shadow:0 0 8px #007acc}
input,button{width:100%;padding:10px;margin:8px 0;border:none;border-radius:10px;font-size:16px}
input{background:rgba(0,50,80,.3);color:#e0e0e0}
input::placeholder{color:#888}
button{
  background:linear-gradient(90deg,#007acc,#00bfff);color:white;font-weight:600;
  cursor:pointer;transition:.3s;box-shadow:0 0 10px rgba(0,150,255,.4)
}
button:hover{
  background:linear-gradient(90deg,#0097a7,#00e6ff);
  box-shadow:0 0 15px rgba(0,150,255,.7)
}
#chatBox{display:none;flex-direction:column;height:420px}
#messages{flex:1;overflow-y:auto;padding:10px;display:flex;flex-direction:column;gap:8px;position:relative}
.bubble{padding:10px 14px;border-radius:12px;max-width:80%;word-wrap:break-word;font-size:15px;transition:0.5s;}
.me{align-self:flex-end;background:linear-gradient(90deg,#0066cc,#0099ff);color:white;box-shadow:0 0 10px rgba(0,150,255,.4);}
.other{align-self:flex-start;background:rgba(0,80,130,.3);color:#b3e5ff;}
#msgInput{background:rgba(0,40,80,.5);color:#fff;}
#codeDisplay{text-align:center;margin-bottom:8px;color:#00bfff;font-weight:500}
#typingIndicator{font-size:14px;color:#00bfff;margin-bottom:4px;height:18px;}
/* Watermark */
#watermark{
  position: fixed; bottom:5px; right:10px;
  opacity:0.15; font-size:12px;
  pointer-events:none; color:#00bfff;
}
/* Scrollbar */
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-thumb{background:#007acc;border-radius:3px}::-webkit-scrollbar-track{background:rgba(255,255,255,.05);}
</style>
</head>
<body>

<div class="container" id="joinSection">
  <h2>âš¡ # Chat</h2>
  <input type="text" id="chatCode" placeholder="Enter or create chat code">
  <button onclick="generateCode()">ðŸŽ² Generate Code</button>
  <button onclick="joinChat()">ðŸš€ Join Chat</button>
</div>

<div class="container" id="chatBox">
  <p id="codeDisplay"></p>
  <div id="typingIndicator"></div>
  <div id="messages"></div>
  <div>
    <input type="text" id="msgInput" placeholder="Type your message..." oninput="notifyTyping()">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>

<div id="watermark">Â© # Chat</div>

<script>
/* ---------- Firebase Setup ---------- */
const firebaseConfig = {
  apiKey:"YOUR_API_KEY",
  authDomain:"YOUR_PROJECT.firebaseapp.com",
  databaseURL:"https://YOUR_PROJECT.firebaseio.com",
  projectId:"YOUR_PROJECT_ID",
  storageBucket:"YOUR_PROJECT.appspot.com",
  messagingSenderId:"SENDER_ID",
  appId:"APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.database();

/* ---------- Morse Conversion ---------- */
const morseMap={
  A:".-",B:"-...",C:"-.-.",D:"-..",E:".",F:"..-.",G:"--.",H:"....",I:"..",
  J:".---",K:"-.-",L:".-..",M:"--",N:"-.",O:"---",P:".--.",Q:"--.-",R:".-.",
  S:"...",T:"-",U:"..-",V:"...-",W:".--",X:"-..-",Y:"-.--",Z:"--..",
  1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",
  8:"---..",9:"----.",0:"-----"," ":"/"
};
const revMorse=Object.entries(morseMap).reduce((a,[k,v])=>(a[v]=k,a),{});
function textToMorse(txt){ return txt.toUpperCase().split("").map(ch=>morseMap[ch]||"").join(" "); }
function morseToText(code){ return code.split(" ").map(c=>revMorse[c]||"").join(""); }

/* ---------- Chat Logic ---------- */
let chatRef=null, code="", userTag="user-"+Math.random().toString(36).substring(2,5);
let typingTimeout;

function generateCode(){ document.getElementById('chatCode').value=Math.random().toString(36).substring(2,8); }

function joinChat(){
  code=document.getElementById('chatCode').value.trim();
  if(!code)return alert("Enter a chat code!");
  document.getElementById('joinSection').style.display='none';
  document.getElementById('chatBox').style.display='flex';
  document.getElementById('codeDisplay').innerHTML=`ðŸ”— Chat Code: <b>${code}</b>`;
  chatRef=db.ref('chats/'+code);
  
  chatRef.on('child_added',snap=>{
    const data=snap.val();
    const mine=data.user===userTag;
    displayMessage(data.text,mine);
  });

  db.ref('typing/'+code).on('value',snap=>{
    const val=snap.val();
    const indicator=document.getElementById('typingIndicator');
    indicator.textContent=(val && val!==userTag)?"Typing...":"";
  });

  setTimeout(()=>chatRef.remove(),10*60*1000);
}

function sendMessage(){
  const input=document.getElementById('msgInput');
  const msg=input.value.trim(); if(!msg)return;
  chatRef.push({text:msg,user:userTag});
  input.value="";
  setTyping(false);
}

/* ---------- Typing Indicator ---------- */
function notifyTyping(){
  setTyping(true);
  clearTimeout(typingTimeout);
  typingTimeout=setTimeout(()=>setTyping(false),1500);
}
function setTyping(status){ db.ref('typing/'+code).set(status?userTag:null); }

/* ---------- Display Message with Morse Flip & Ephemeral ---------- */
function displayMessage(msg,mine){
  const div=document.createElement('div');
  div.classList.add('bubble',mine?'me':'other');
  div.textContent=msg; // English initially
  const messages=document.getElementById('messages');
  messages.appendChild(div);
  messages.scrollTop=messages.scrollHeight;

  // Flip to Morse after 2 sec
  setTimeout(()=>{
    div.textContent=textToMorse(msg);
    // Remove message 5 sec after Morse
    setTimeout(()=>{ div.remove(); },5000);
  },2000);
}

// Prevent copy/cut
document.addEventListener('copy',e=>e.preventDefault());
document.addEventListener('cut',e=>e.preventDefault());

// Remove chat if user leaves
window.addEventListener('beforeunload',()=>{ if(chatRef) chatRef.remove(); });
</script>

</body>
</html>
